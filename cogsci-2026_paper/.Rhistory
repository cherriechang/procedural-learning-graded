filter(aic_table_random_slope$isSingular == FALSE) %>%
group_by(model) %>%
summarise(total_AIC = sum(AIC))
aic_table_random_slope %>%
filter(aic_table_random_slope$isSingular == FALSE) %>%
group_by(model) %>%
summarise(total_AIC = sum(AIC)) %>%
arrange(total_AIC)
model_structures_fixed_effect <- list(
base = "surprisal_c * prev_entropy_c + is_repetition",
no_interaction = "surprisal_c + prev_entropy_c + is_repetition",
no_is_repetition = "surprisal_c * prev_entropy_c",
only_main = "surprisal_c + prev_entropy_c",
surprisal_is_repetition = "surprisal_c + is_repetition",
entropy_is_repetition = "prev_entropy_c + is_repetition"
)
all_models_fixed_effect <- map(
model_structures_fixed_effect,
~ map(data_list, function(dat) {
lmer(
as.formula(
paste0("log_rt ~ ", .x, " + (surprisal_c * prev_entropy_c || subject_id) + (1 | position)")
),
data = dat,
REML = FALSE,
control = lmerControl(optimizer = "bobyqa")
)
})
)
aic_table_fixed_effect <- map_dfr(
names(all_models_fixed_effect),
function(model_name) {
map_dfr(
names(all_models_fixed_effect[[model_name]]),
function(cond) {
m <- all_models_fixed_effect[[model_name]][[cond]]
data.frame(
model = model_name,
matrix_size = cond,
AIC = AIC(m),
isSingular = isSingular(m)
)
}
)
}
)
aic_table_fixed_effect %>%
filter(aic_table_fixed_effect$isSingular == FALSE) %>%
group_by(model) %>%
summarise(total_AIC = sum(AIC)) %>%
arrange(total_AIC)
#group_by(matrix_size) %>%
#arrange(matrix_size, AIC)
aic_table_fixed_effect %>%
filter(aic_table_fixed_effect$isSingular == TRUE)
aic_table_fixed_effect %>%
filter(aic_table_fixed_effect$isSingular == FALSE) %>%
group_by(model) %>%
summarise(total_AIC = sum(AIC)) %>%
arrange(total_AIC)
model_summaries[2]
# last block data model, for each of the matrix_size: plotting fixed effects (exclude intercepts)
effects_df <- map_dfr(
names(models),
~ broom.mixed::tidy(models[[.x]]) %>%
filter(effect == "fixed" & term != "(Intercept)") %>%
mutate(matrix_size = .x)
)
effects_df$matrix_size <- as.numeric(effects_df$matrix_size)
ggplot(effects_df, aes(x = matrix_size, y = estimate, color = term, group = term)) +
geom_line() +
geom_point() +
geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error), width = 0.2) +
labs(x = "Matrix Size", y = "Effect Estimate", color = "Parameter") +
theme_minimal()
data_m4 <- subset(df, matrix_size == 4) # can change
data_list_block <- split(data_m4, data_m4$block)
models_block <- map(data_list_block, ~ lmer(
log_rt ~ surprisal_c * prev_entropy_c + is_repetition +
(surprisal_c * prev_entropy_c || subject_id) + (1 | position),
data = .x
))
effects_block <- map_dfr(
names(models_block),
~ broom.mixed::tidy(models_block[[.x]]) %>%
filter(effect == "fixed" & term != "(Intercept)") %>%
mutate(block = as.numeric(.x))
)
ggplot(effects_block, aes(x = block, y = estimate, color = term, group = term)) +
geom_line() +
geom_point() +
geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error), width = 0.2) +
labs(x = "Block", y = "Effect Estimate", color = "Parameter") +
theme_minimal()
data_m4 <- subset(df, matrix_size == 8) # can change
data_list_block <- split(data_m4, data_m4$block)
models_block <- map(data_list_block, ~ lmer(
log_rt ~ surprisal_c * prev_entropy_c + is_repetition +
(surprisal_c * prev_entropy_c || subject_id) + (1 | position),
data = .x
))
effects_block <- map_dfr(
names(models_block),
~ broom.mixed::tidy(models_block[[.x]]) %>%
filter(effect == "fixed" & term != "(Intercept)") %>%
mutate(block = as.numeric(.x))
)
ggplot(effects_block, aes(x = block, y = estimate, color = term, group = term)) +
geom_line() +
geom_point() +
geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error), width = 0.2) +
labs(x = "Block", y = "Effect Estimate", color = "Parameter") +
theme_minimal()
View(data_list_block)
View(df)
data_m4 <- subset(df, matrix_size == 4) # can change
data_list_block <- split(data_m4, data_m4$block)
models_block <- map(data_list_block, ~ lmer(
log_rt ~ surprisal_c * prev_entropy_c + is_repetition +
(surprisal_c + prev_entropy_c | subject_id) + (1 | position),
data = .x
))
models_block <- map(data_list_block, ~ lmer(
log_rt ~ surprisal_c * prev_entropy_c + is_repetition +
(surprisal_c | subject_id) + (1 | position),
data = .x
))
models_block <- map(data_list_block, ~ lmer(
log_rt ~ surprisal_c * prev_entropy_c + is_repetition +
(prev_entropy_c | subject_id) + (1 | position),
data = .x
))
models_block <- map(data_list_block, ~ lmer(
log_rt ~ surprisal_c * prev_entropy_c + is_repetition +
(1 | subject_id) + (1 | position),
data = .x
))
models_block <- map(data_list_block, ~ lmer(
log_rt ~ surprisal_c * prev_entropy_c + is_repetition +
(is_repetition | subject_id) + (1 | position),
data = .x
))
models_block <- map(data_list_block, ~ lmer(
log_rt ~ surprisal_c * prev_entropy_c + is_repetition +
(surprisal_c * prev_entropy_c || subject_id) + (1 | position),
data = .x,
REML = FALSE,
control = lmerControl(optimizer = "bobyqa")
))
models_block <- map(data_list_block, ~ lmer(
log_rt ~ surprisal_c * prev_entropy_c + is_repetition +
(surprisal_c + prev_entropy_c | subject_id) + (1 | position),
data = .x,
REML = FALSE,
control = lmerControl(optimizer = "bobyqa")
))
models_block <- map(data_list_block, ~ lmer(
log_rt ~ surprisal_c * prev_entropy_c + is_repetition +
(surprisal_c | subject_id) + (1 | position),
data = .x,
REML = FALSE,
control = lmerControl(optimizer = "bobyqa")
))
models_block <- map(data_list_block, ~ lmer(
log_rt ~ surprisal_c * prev_entropy_c + is_repetition +
(prev_entropy_c | subject_id) + (1 | position),
data = .x,
REML = FALSE,
control = lmerControl(optimizer = "bobyqa")
))
models_block <- map(data_list_block, ~ lmer(
log_rt ~ surprisal_c * prev_entropy_c + is_repetition +
(prev_entropy_c + is_repetition | subject_id) + (1 | position),
data = .x,
REML = FALSE,
control = lmerControl(optimizer = "bobyqa")
))
data_m4 <- subset(df, matrix_size == 5) # can change
data_list_block <- split(data_m4, data_m4$block)
models_block <- map(data_list_block, ~ lmer(
log_rt ~ surprisal_c * prev_entropy_c + is_repetition +
(prev_entropy_c | subject_id) + (1 | position),
data = .x,
REML = FALSE,
control = lmerControl(optimizer = "bobyqa")
))
View(data_m4)
models_block <- map(data_list_block, ~ lmer(
log_rt ~ surprisal_c * prev_entropy_c + is_repetition +
(prev_entropy_c | subject_id) + (1 | position),
data = .x,
REML = FALSE,
control = lmerControl(optimizer = "bobyqa")
))
df %>%
filter(is.infinite(log_rt))
data_m4 <- subset(df, matrix_size == 5 & !is.infinite(log_rt)) # can change
data_list_block <- split(data_m4, data_m4$block)
models_block <- map(data_list_block, ~ lmer(
log_rt ~ surprisal_c * prev_entropy_c + is_repetition +
(prev_entropy_c | subject_id) + (1 | position),
data = .x,
REML = FALSE,
control = lmerControl(optimizer = "bobyqa")
))
data_m4 <- subset(df, matrix_size == 6 & !is.infinite(log_rt)) # can change
data_list_block <- split(data_m4, data_m4$block)
models_block <- map(data_list_block, ~ lmer(
log_rt ~ surprisal_c * prev_entropy_c + is_repetition +
(prev_entropy_c | subject_id) + (1 | position),
data = .x,
REML = FALSE,
control = lmerControl(optimizer = "bobyqa")
))
data_m4 <- subset(df, matrix_size == 7 & !is.infinite(log_rt)) # can change
data_list_block <- split(data_m4, data_m4$block)
models_block <- map(data_list_block, ~ lmer(
log_rt ~ surprisal_c * prev_entropy_c + is_repetition +
(prev_entropy_c | subject_id) + (1 | position),
data = .x,
REML = FALSE,
control = lmerControl(optimizer = "bobyqa")
))
data_m4 <- subset(df, matrix_size == 4 & !is.infinite(log_rt)) # can change
data_list_block <- split(data_m4, data_m4$block)
models_block <- map(data_list_block, ~ lmer(
log_rt ~ surprisal_c * prev_entropy_c + is_repetition +
(prev_entropy_c | subject_id) + (1 | position),
data = .x,
REML = FALSE,
control = lmerControl(optimizer = "bobyqa")
))
effects_block <- map_dfr(
names(models_block),
~ broom.mixed::tidy(models_block[[.x]]) %>%
filter(effect == "fixed" & term != "(Intercept)") %>%
mutate(block = as.numeric(.x))
)
ggplot(effects_block, aes(x = block, y = estimate, color = term, group = term)) +
geom_line() +
geom_point() +
geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error), width = 0.2) +
labs(x = "Block", y = "Effect Estimate", color = "Parameter") +
theme_minimal()
data.m_h1h2_all_blocks <- df %>% filter(!is.infinite(log_rt))
data_list_all_blocks <- split(data.m_h1h2_all_blocks, data.m_h1h2_all_blocks$matrix_size)
models_all <- map(data_list_all_blocks, ~ lmer(
log_rt ~ surprisal_c * prev_entropy_c * block + block * is_repetition +
(surprisal_c + prev_entropy_c + is_repetition + block | subject_id) + (1 | position),
data = .x,
REML=FALSE,
control=lmerControl(optimizer="bobyqa")))
model_summaries_all_blocks <- map(models_all, summary)
model_summaries_all_blocks[2]
model_summaries_all_blocks[5]
model_summaries_block <- map(models_block, summary)
model_summaries_block[0]
model_summaries_block[1]
model_summaries_block[2]
model_summaries_block[3]
model_summaries_block[20]
model_summaries_block[10]
effects_block <- map_dfr(
names(models_block),
~ broom.mixed::tidy(models_block[[.x]]) %>%
filter(effect == "fixed" & term != "(Intercept)") %>%
mutate(block = as.numeric(.x))
)
ggplot(effects_block, aes(x = block, y = estimate, color = term, group = term)) +
geom_line() +
geom_point() +
geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error), width = 0.2) +
labs(x = "Block", y = "Effect Estimate", color = "Parameter") +
theme_minimal()
effects_block <- map_dfr(
names(models_block),
~ broom.mixed::tidy(models_block[[.x]]) %>%
filter(effect == "fixed" & term != "(Intercept)") %>%
mutate(block = as.numeric(.x))
) %>%
mutate(
sig_label = case_when(
p.value < 0.001 ~ "***",
p.value < 0.01 ~ "**",
p.value < 0.05 ~ "*",
TRUE ~ ""
)
)
ggplot(effects_block, aes(x = block, y = estimate, color = term, group = term)) +
geom_line() +
geom_point() +
geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error), width = 0.2) +
geom_text(aes(label = sig_label), vjust = -1.2, size = 5) +
labs(x = "Block", y = "Effect Estimate", color = "Parameter") +
theme_minimal()
ggplot(effects_df, aes(x = matrix_size, y = estimate, color = term, group = term)) +
geom_line() +
geom_point() +
geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error), width = 0.2) +
geom_text(aes(label = sig_label), vjust = -1.2, size = 5)
effects_df <- map_dfr(
names(models),
~ broom.mixed::tidy(models[[.x]]) %>%
filter(effect == "fixed" & term != "(Intercept)") %>%
mutate(matrix_size = .x)
) %>%
mutate(
sig_label = case_when(
p.value < 0.001 ~ "***",
p.value < 0.01 ~ "**",
p.value < 0.05 ~ "*",
TRUE ~ ""
)
)
effects_df$matrix_size <- as.numeric(effects_df$matrix_size)
ggplot(effects_df, aes(x = matrix_size, y = estimate, color = term, group = term)) +
geom_line() +
geom_point() +
geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error), width = 0.2) +
geom_text(aes(label = sig_label), vjust = -1.2, size = 5)
labs(x = "Matrix Size", y = "Effect Estimate", color = "Parameter") +
theme_minimal()
unique(effects_df$term)
ggplot(effects_df, aes(x = matrix_size, y = estimate, color = term, group = term)) +
geom_line() +
geom_point() +
geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error), width = 0.2) +
geom_text(aes(label = sig_label), vjust = -1.2, size = 5, show.legend = FALSE)
ggplot(effects_block, aes(x = block, y = estimate, color = term, group = term)) +
geom_line() +
geom_point() +
geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error), width = 0.2) +
geom_text(aes(label = sig_label), vjust = -1.2, size = 5, show.legend = FALSE) +
labs(x = "Block", y = "Effect Estimate", color = "Parameter") +
theme_minimal()
labs(x = "Matrix Size", y = "Effect Estimate", color = "Parameter") +
theme_minimal()
effects_df <- map_dfr(
names(models),
~ broom.mixed::tidy(models[[.x]]) %>%
filter(effect == "fixed" & term != "(Intercept)") %>%
mutate(matrix_size = .x)
) %>%
mutate(
sig_label = case_when(
p.value < 0.001 ~ "***",
p.value < 0.01 ~ "**",
p.value < 0.05 ~ "*",
TRUE ~ ""
)
)
#effects_df$matrix_size <- as.numeric(effects_df$matrix_size)
ggplot(effects_df, aes(x = matrix_size, y = estimate, color = term, group = term)) +
geom_line() +
geom_point() +
geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error), width = 0.2) +
geom_text(aes(label = sig_label), vjust = -1.2, size = 5, show.legend = FALSE)
labs(x = "Matrix Size", y = "Effect Estimate", color = "Parameter") +
theme_minimal()
theme_set(theme_minimal())
ggplot(effects_df, aes(x = matrix_size, y = estimate, color = term, group = term)) +
geom_line() +
geom_point() +
geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error), width = 0.2) +
geom_text(aes(label = sig_label), vjust = -1.2, size = 5, show.legend = FALSE)
View(model_structures_fixed_effect)
View(models_all)
iwalk(models_all, function(model, name) {
saveRDS(model, paste0("./models/all_block_models_", name, ".rds"))
})
iwalk(models_all, function(model, name) {
saveRDS(model, paste0("./models/all_block/all_block_models_", name, ".rds"))
})
saveRDS(model, paste0("./models/all_block_per_condition/all_block_models_", name, ".rds"))
iwalk(models_all, function(model, name) {
saveRDS(model, paste0("./models/all_block_per_condition/all_block_models_", name, ".rds"))
})
cur_condition <- 4
data_m4 <- subset(df, matrix_size == cur_condition & !is.infinite(log_rt)) # can change
data_list_block <- split(data_m4, data_m4$block)
# random effects: (prev_entropy_c | subject_id) + (1 | position) no singular fit for all conditions
models_block <- map2(names(data_list_block),
data_list_block,
function(name, dat) {
model_path <- paste0("./models/per_block_condition_", cur_condition, "/model_block_", name, ".rds")
dir_path <- dirname(model_path)
if (!dir.exists(dir_path)) dir.create(dir_path, recursive = TRUE)
if (file.exists(model_path)) {
readRDS(model_path)
} else {
m <- lmer(
log_rt ~ surprisal_c * prev_entropy_c + is_repetition +
(prev_entropy_c | subject_id) + (1 | position),
data = dat,
REML = FALSE,
control = lmerControl(optimizer = "bobyqa")
)
saveRDS(m, model_path)
m
}
}
)
model_summaries_block <- map(models_block, summary)
model_summaries_block[10]
cur_condition <- 5
data_m4 <- subset(df, matrix_size == cur_condition & !is.infinite(log_rt)) # can change
data_list_block <- split(data_m4, data_m4$block)
# random effects: (prev_entropy_c | subject_id) + (1 | position) no singular fit for all conditions
models_block <- map2(names(data_list_block),
data_list_block,
function(name, dat) {
model_path <- paste0("./models/per_block_condition_", cur_condition, "/model_block_", name, ".rds")
dir_path <- dirname(model_path)
if (!dir.exists(dir_path)) dir.create(dir_path, recursive = TRUE)
if (file.exists(model_path)) {
readRDS(model_path)
} else {
m <- lmer(
log_rt ~ surprisal_c * prev_entropy_c + is_repetition +
(prev_entropy_c | subject_id) + (1 | position),
data = dat,
REML = FALSE,
control = lmerControl(optimizer = "bobyqa")
)
saveRDS(m, model_path)
m
}
}
)
model_summaries_block <- map(models_block, summary)
model_summaries_block[10]
cur_condition <- 6
data_m4 <- subset(df, matrix_size == cur_condition & !is.infinite(log_rt)) # can change
data_list_block <- split(data_m4, data_m4$block)
# random effects: (prev_entropy_c | subject_id) + (1 | position) no singular fit for all conditions
models_block <- map2(names(data_list_block),
data_list_block,
function(name, dat) {
model_path <- paste0("./models/per_block_condition_", cur_condition, "/model_block_", name, ".rds")
dir_path <- dirname(model_path)
if (!dir.exists(dir_path)) dir.create(dir_path, recursive = TRUE)
if (file.exists(model_path)) {
readRDS(model_path)
} else {
m <- lmer(
log_rt ~ surprisal_c * prev_entropy_c + is_repetition +
(prev_entropy_c | subject_id) + (1 | position),
data = dat,
REML = FALSE,
control = lmerControl(optimizer = "bobyqa")
)
saveRDS(m, model_path)
m
}
}
)
model_summaries_block <- map(models_block, summary)
model_summaries_block[10]
cur_condition <- 7
data_m4 <- subset(df, matrix_size == cur_condition & !is.infinite(log_rt)) # can change
data_list_block <- split(data_m4, data_m4$block)
# random effects: (prev_entropy_c | subject_id) + (1 | position) no singular fit for all conditions
models_block <- map2(names(data_list_block),
data_list_block,
function(name, dat) {
model_path <- paste0("./models/per_block_condition_", cur_condition, "/model_block_", name, ".rds")
dir_path <- dirname(model_path)
if (!dir.exists(dir_path)) dir.create(dir_path, recursive = TRUE)
if (file.exists(model_path)) {
readRDS(model_path)
} else {
m <- lmer(
log_rt ~ surprisal_c * prev_entropy_c + is_repetition +
(prev_entropy_c | subject_id) + (1 | position),
data = dat,
REML = FALSE,
control = lmerControl(optimizer = "bobyqa")
)
saveRDS(m, model_path)
m
}
}
)
model_summaries_block <- map(models_block, summary)
model_summaries_block[10]
cur_condition <- 8
data_m4 <- subset(df, matrix_size == cur_condition & !is.infinite(log_rt)) # can change
data_list_block <- split(data_m4, data_m4$block)
# random effects: (prev_entropy_c | subject_id) + (1 | position) no singular fit for all conditions
models_block <- map2(names(data_list_block),
data_list_block,
function(name, dat) {
model_path <- paste0("./models/per_block_condition_", cur_condition, "/model_block_", name, ".rds")
dir_path <- dirname(model_path)
if (!dir.exists(dir_path)) dir.create(dir_path, recursive = TRUE)
if (file.exists(model_path)) {
readRDS(model_path)
} else {
m <- lmer(
log_rt ~ surprisal_c * prev_entropy_c + is_repetition +
(prev_entropy_c | subject_id) + (1 | position),
data = dat,
REML = FALSE,
control = lmerControl(optimizer = "bobyqa")
)
saveRDS(m, model_path)
m
}
}
)
model_summaries_block <- map(models_block, summary)
model_summaries_block[10]
